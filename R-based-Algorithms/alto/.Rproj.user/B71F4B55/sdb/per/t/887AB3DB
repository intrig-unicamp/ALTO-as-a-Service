{
    "contents" : "library(\"data.table\")\n\nbgp.rib.m.anas.filter <- function(input.data, output.path){\n        \n        if (file.exists(input.data)){\n                if (file.info(input.data)$isdir){     \n                        files <- list.files(input.data, full.names = TRUE)\n                } else {\n                        files <- input.data\n                }\n        } else {\n                stop(paste(input.data, \" not found.\", sep=\"\"))\n        }\n        \n        i <- 0 \n        for(f in files){\n                \n                file.name <- gsub(\".*/\",\"\", sub(\"\\\\.[[:alnum:]]+$\", \"\", f))\n                \n                file.name <- sub(\".csv\", \"\", file.name)\n        \n                cat(\"Processing \", f)\n                \n                file.output.pre <- paste(output.path, \"/\", file.name, \n                                         sep = \"\")\n                \n                rib <- data.table(read.csv(f))\n                \n                tryCatch({\n                        rib.alto.1 <- rib[,.(network, netmask, path)]\n                        rib.alto.1$path <- \n                                sapply(rib.alto.1$path, \n                                       function(x) substring(x, regexpr(\"[0-9]*$\", x)[1]))\n                        rib.alto.1 <- unique(rib.alto.1)\n                        rib.alto.1 <- rib.alto.1[!rib.alto.1$path == \"\"]\n                        \n                        ## Unique and without aggregation\n                        dup <-  duplicated(rib.alto.1, \n                                           by=c(\"network\",\"netmask\")) | \n                                duplicated(rib.alto.1, \n                                           fromLast = TRUE, \n                                           by=c(\"network\",\"netmask\"))\n                        \n                        \n                        rib.alto.1.1 <- rib.alto.1[!dup,]\n                        \n                        if (! file.exists(output.path)){\n                                dir.create(output.path, recursive = TRUE)\n                        }\n                        \n                        write.table(rib.alto.1.1, \n                                    paste(file.output.pre,\".wau.csv\", sep = \"\"), \n                                    row.names = FALSE, quote=FALSE, col.names = FALSE,\n                                    sep=',')\n                        \n                        ## Repeted network and mask\n                        rib.alto.1.2 <- rib.alto.1[dup,]\n                        write.table(rib.alto.1.2, \n                                    paste(file.output.pre,\".rep.csv\", sep = \"\"), \n                                    row.names = FALSE, quote=FALSE, col.names = FALSE, \n                                    sep=',')\n                        \n                        ## Aggregated Path\n                        rib.alto.2 <- \n                                rib[rib$path %like% \"\\\\{|\\\\}|\\\\(|\\\\)\"][,.(network, netmask, \n                                                                        path)]\n                        rib.alto.2$path <- \n                                sapply(rib.alto.2$path, \n                                       function(x) substring(x, \n                                              regexpr(\"([0-9]* \\\\{.*\\\\}$)|([0-9]* \\\\(.*\\\\)$)\", \n                                                                        x)[1]))\n                        \n                        rib.alto.2 <- unique(rib.alto.2)\n                        write.table(rib.alto.2, \n                                    paste(file.output.pre,\".agg.csv\", sep = \"\"), \n                                    row.names = FALSE, quote=FALSE, \n                                    col.names = FALSE, ,sep=',')  \n                }, error =  function(e) {\n                        cat(\"  -> Could not process file\")\n                })\n                cat(\"\\n\")\n        }\n}\n\n\n\n",
    "created" : 1432731578657.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2093236883",
    "id" : "887AB3DB",
    "lastKnownWriteTime" : 1438781305,
    "path" : "~/Dropbox/Remote Workspace/Unicamp/alto/alto.R",
    "project_path" : "alto.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}